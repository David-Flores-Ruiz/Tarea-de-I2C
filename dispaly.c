/*
 * dispaly.c
 *
 *  Created on: 13 nov 2019
 *      Author: pacas
 */
#include "display.h"
#include "I2C.h"
#include "MK64F12.h"
#include "bits.h"


/*
const uint8_t letra_A[] = {0x00, 0x3F, 0x7F, 0xCC, 0xCC, 0x7F, 0x3F, 0x00};
const uint8_t letra_B[] = { 0x00, 0xff, 0xff, 0xc9, 0xc9, 0x49, 0x36, 0x00 };
const uint8_t letra_C[] = { 0x00, 0xff, 0xff, 0xc3, 0xc3, 0xc3, 0xc3, 0x00 };
const uint8_t letra_D[] = { 0x00, 0xff, 0xff, 0xc3, 0xc3, 0x7e, 0x3c, 0x00 };
const uint8_t letra_E[] = { 0x00, 0xFF, 0xFF, 0xDB, 0xDB, 0xC3, 0xC3, 0x00 };
const uint8_t letra_F[] = { 0x00, 0xff, 0xff, 0x33, 0x33, 0x03, 0x03, 0x00 };
const uint8_t letra_G[] = { 0x00, 0xff, 0xff, 0xdb, 0xdb, 0xfb, 0xfb, 0x00 };
const uint8_t letra_H[] = { 0x00, 0xff, 0xff, 0x18, 0x18, 0xff, 0xff, 0x00 };
const uint8_t letra_I[] = { 0x00, 0xC3, 0xC3, 0xFF, 0xFF, 0xC3, 0xC3, 0x00 };
const uint8_t letra_J[] = { 0x00, 0x03, 0x7f, 0xff, 0x83, 0xc3, 0x63, 0x00 };
const uint8_t letra_K[] = { 0x00, 0xff, 0xff, 0x18, 0x3c, 0x66, 0xc3, 0x00 };
const uint8_t letra_L[] = { 0x00, 0xff, 0xff, 0xc0, 0xc0, 0xc0, 0xc0, 0x00 };
const uint8_t letra_M[] = { 0x00, 0xff, 0xfc, 0x08, 0x08, 0xfc, 0xff, 0x00 };
const uint8_t letra_N[] = { 0x00, 0xff, 0x06, 0x0c, 0x18, 0x30, 0xff, 0x00 };
const uint8_t letra_O[] = { 0x00, 0xFF, 0xFF, 0xC3, 0xC3, 0xFF, 0xFF, 0x00 };
const uint8_t letra_P[] = { 0x00, 0xff, 0xff, 0x09, 0x09, 0x09, 0x0f, 0x00 };
const uint8_t letra_Q[] = { 0x00, 0x7f, 0x41, 0x41, 0x71, 0x71, 0xff, 0xc0 };
const uint8_t letra_R[] = { 0x00, 0xff, 0xff, 0x19, 0x39, 0x69, 0xcf, 0x00 };
const uint8_t letra_S[] = { 0x00, 0xdf, 0xdf, 0xdb, 0xdb, 0xdb, 0xfb, 0x00 };
const uint8_t letra_T[] = { 0x00, 0xC0, 0xC0, 0xFF, 0xFF, 0xC0, 0xC0, 0x00 };
const uint8_t letra_U[] = { 0x00, 0xff, 0xff, 0xc0, 0xc0, 0xff, 0xff, 0x00 };
const uint8_t letra_V[] = { 0x00, 0x3f, 0x7f, 0xc0, 0xc0, 0xff, 0x3f, 0x00 };
const uint8_t letra_W[] = { 0x00, 0x7f, 0xe0, 0xf0, 0xf0, 0xe0, 0x7f, 0x00 };
const uint8_t letra_X[] = { 0x00, 0xe3, 0x36, 0x1c, 0x1c, 0x36, 0xe3, 0x00 };
const uint8_t letra_Y[] = { 0x00, 0x07, 0x0c, 0xf8, 0xf8, 0x0c, 0x07, 0x00 };
const uint8_t letra_Z[] = { 0x00, 0xfb, 0xfb, 0xdb, 0xdb, 0xdf, 0xdf, 0x00 };

const uint8_t minutos_00[] = { 0x0, 0xff, 0x81, 0xff, 0x0, 0xff, 0x81, 0xff};
const uint8_t minutos_01[] = { 0x0, 0xff, 0x81, 0xff, 0x0, 0xff, 0x0, 0x0};
const uint8_t minutos_02[] = { 0x0, 0xff, 0x81, 0xff,0x0, 0x8f, 0x89, 0xf9};
const uint8_t minutos_03[] = { 0x0, 0xff, 0x81, 0xff, 0x0, 0x89, 0x89, 0xff};
const uint8_t minutos_04[] = { 0x0, 0xff, 0x81, 0xff, 0x0, 0xf0, 0x10, 0xff };
const uint8_t minutos_05[] = { 0x0, 0xff, 0x81, 0xff,  0x0, 0xf9, 0x89, 0x8f};
const uint8_t minutos_06[] = { 0x0, 0xff, 0x81, 0xff,  0x0, 0xff, 0x89, 0xcf };
const uint8_t minutos_07[] = { 0x0, 0xff, 0x81, 0xff, 0x0, 0x80, 0x80, 0xff};
const uint8_t minutos_08[] = { 0x0, 0xff, 0x81, 0xff, 0x0, 0xff, 0x89, 0xff};
const uint8_t minutos_09[] = { 0x0, 0xff, 0x81, 0xff,0x0, 0xf1, 0x91,0xff };

const uint8_t minutos_10[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0xff, 0x81, 0xff};
const uint8_t minutos_11[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0xff, 0x0,  0x00};
const uint8_t minutos_12[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0x8f, 0x89, 0xf9};
const uint8_t minutos_13[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0x89, 0x89, 0xff};
const uint8_t minutos_14[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0xf0, 0x10, 0xff};
const uint8_t minutos_15[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0xf9, 0x89, 0x8f};
const uint8_t minutos_16[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0xff, 0x89, 0xcf};
const uint8_t minutos_17[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0x80, 0x80, 0xff};
const uint8_t minutos_18[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0xff, 0x89, 0xff};
const uint8_t minutos_19[] = { 0x0, 0xff, 0x0, 0x0, 0x0, 0xf1, 0x91, 0xff};

const uint8_t minutos_20[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0xff, 0x81, 0xff};
const uint8_t minutos_21[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0xff, 0x00, 0x00};
const uint8_t minutos_22[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0x8f, 0x89, 0xf9};
const uint8_t minutos_23[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0x89, 0x89, 0xff};
const uint8_t minutos_24[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0xf0, 0x10, 0xff};
const uint8_t minutos_25[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0xf9, 0x89, 0x8f};
const uint8_t minutos_26[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0xff, 0x89, 0xcf};
const uint8_t minutos_27[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0x80, 0x80, 0xff};
const uint8_t minutos_28[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0xff, 0x89, 0xff};
const uint8_t minutos_29[] = {0x0, 0x8f, 0x89, 0xf9, 0x0, 0xf1, 0x91, 0xff};

const uint8_t minutos_30[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0xff, 0x81, 0xff};
const uint8_t minutos_31[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0xff, 0x00, 0x00};
const uint8_t minutos_32[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0x8f, 0x89, 0xf9};
const uint8_t minutos_33[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0x89, 0x89, 0xff};
const uint8_t minutos_34[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0xf0, 0x10, 0xff};
const uint8_t minutos_35[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0xf9, 0x89, 0x8f};
const uint8_t minutos_36[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0xff, 0x89, 0xcf};
const uint8_t minutos_37[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0x80, 0x80, 0xff};
const uint8_t minutos_38[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0xff, 0x89, 0xff};
const uint8_t minutos_39[] = {0x0, 0x89, 0x89, 0xff, 0x0, 0xf1, 0x91, 0xff};

const uint8_t minutos_40[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0xff, 0x81, 0xff};
const uint8_t minutos_41[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0xff, 0x00, 0x00};
const uint8_t minutos_42[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0x8f, 0x89, 0xf9};
const uint8_t minutos_43[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0x89, 0x89, 0xff};
const uint8_t minutos_44[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0xf0, 0x10, 0xff};
const uint8_t minutos_45[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0xf9, 0x89, 0x8f};
const uint8_t minutos_46[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0xff, 0x89, 0xcf};
const uint8_t minutos_47[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0x80, 0x80, 0xff};
const uint8_t minutos_48[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0xff, 0x89, 0xff};
const uint8_t minutos_49[] = {0x0, 0xf0, 0x10, 0xff, 0x0, 0xf1, 0x91, 0xff};

const uint8_t minutos_50[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0xff, 0x81, 0xff};
const uint8_t minutos_51[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0xff, 0x00, 0x00};
const uint8_t minutos_52[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0x8f, 0x89, 0xf9};
const uint8_t minutos_53[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0x89, 0x89, 0xff};
const uint8_t minutos_54[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0xf0, 0x10, 0xff};
const uint8_t minutos_55[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0xf9, 0x89, 0x8f};
const uint8_t minutos_56[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0xff, 0x89, 0xcf};
const uint8_t minutos_57[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0x80, 0x80, 0xff};
const uint8_t minutos_58[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0xff, 0x89, 0xff};
const uint8_t minutos_59[] = { 0x0, 0xf9, 0x89, 0x8f, 0x0, 0xf1, 0x91, 0xff};

*/
const uint8_t posiciones_primer_cubo[]={
		pos_0, pos_1, pos_2, pos_3, pos_4,
		pos_5, pos_6, pos_7,  };
const uint8_t posiciones_segundo_cubo[]={
		pos_0_2, pos_1_2, pos_2_2, pos_3_2,
		pos_4_2, pos_5_2, pos_6_2, pos_7_2, };

static uint8_t flag1 = 1;
	static uint8_t flag2 = 0;
	static uint8_t cont_primero = 0;
		static uint8_t cont_segundo = 0;
void display_clear(void){
	I2C_start(); //** It configures de I2C in transmitting mode and generates the start signal */
		I2C_write_byte(DISPLAY_ADDRESS_WRITE);
		I2C_wait();
		I2C_write_byte(0x00);
		I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_write_byte(0);
			I2C_wait();
			I2C_stop();
}

void display_init(void){
	I2C_start(); //** It configures de I2C in transmitting mode and generates the start signal */
	I2C_write_byte(DISPLAY_ADDRESS_WRITE); //** Writing RTC address in the data register */
	I2C_wait();	//** Checking if the I2C module is busy */
	I2C_write_byte(0x21);
	I2C_wait();
	//I2C_stop();

//	I2C_start(); //** It configures de I2C in transmitting mode and generates the start signal */
	I2C_write_byte(0xE0); //** Writing RTC address in the data register */
	I2C_wait();	//** Checking if the I2C module is busy */
	I2C_write_byte(0x81);
	I2C_wait();
//

//	I2C_start(); //** It configures de I2C in transmitting mode and generates the start signal */
	I2C_write_byte(0xE0); //** Writing RTC address in the data register */
	I2C_wait();	//** Checking if the I2C module is busy */
	I2C_write_byte(0xEF);
	I2C_wait();
	I2C_stop();
	I2C_start();
	I2C_write_byte(DISPLAY_ADDRESS_WRITE);
	I2C_wait();
	I2C_write_byte(0x81);
	I2C_wait();
	I2C_stop();
	//acknowledge = I2C_get_ack_or_nack(); /* Waiting for the acknowledge, this function is able to detect
	 // Return 0: if an acknowledge was received!!!	 * if an acknowledge was received by checking the RXAK
}


void display_instruccion_debug_minutos(uint8_t array2[]){
	if (flag2 == TRUE) {
			I2C_start();
			I2C_write_byte(DISPLAY_ADDRESS_WRITE);
			I2C_wait();
			I2C_write_byte(posiciones_segundo_cubo[cont_segundo]);
			I2C_wait();
			I2C_write_byte(array2[cont_segundo]);
			cont_segundo++;
			I2C_wait();
			I2C_stop();
		}
		if (cont_segundo == 8) {
			flag1 = TRUE;
			flag2 = FALSE;
			cont_segundo = 0;
		}
}

void display_instruccion_debug_horas(uint8_t array1[]){

	if ( flag1== TRUE) {
		I2C_start();
		I2C_write_byte(DISPLAY_ADDRESS_WRITE); // 0xE0
		I2C_wait();
		I2C_write_byte(posiciones_primer_cubo[cont_primero]); //direccion de fila de led
		I2C_wait();
		I2C_write_byte(array1[cont_primero]);
		cont_primero++;
		I2C_wait();
		I2C_stop();
	}

	if (cont_primero == 8) {
		flag1 = TRUE;
		flag2 = TRUE;
		cont_primero = 0;
	}

}
void delay(uint16_t delay) {
	volatile uint16_t j, i;

	for (j = delay; j > 0; j--) {
		for (i = 0; i < 1000; ++i) {
			__asm("nop");
		}

	}
}

